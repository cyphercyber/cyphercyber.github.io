<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Digital Forensics Lab: Compromised System Investigation</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Inconsolata:wght@400;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Slate & Cyan -->
    <!-- Application Structure Plan: A task-oriented, single-page application with tabbed navigation. The structure guides the user through a logical workflow: 1. Overview (Introduction), 2. Setup (Interactive Checklist), 3. Workbench (The core analysis steps separated by tool), and 4. Findings (The final questions). This non-linear, sectioned approach is chosen over a long document to break down the complex process into manageable, focused stages. It improves usability by allowing users to concentrate on one task at a time (e.g., setup vs. analysis) and easily navigate between different parts of the lab without extensive scrolling, creating a more organized and less overwhelming learning experience. -->
    <!-- Visualization & Content Choices: The report is a procedural guide, lacking quantitative data for charts. Therefore, content is organized into interactive components. A key visualization is the 'Investigation Workflow' diagram, built with HTML/CSS Flexbox, to provide a high-level map of the lab process (Goal: Organize). Interactive checklists in the 'Setup' section (Goal: Inform/Track) allow users to mark progress. Core analysis steps are presented in tabbed sections with copy-to-clipboard functionality for commands (Goal: Instruct/Simplify), reducing errors. Final questions are in a 'Findings' section with text areas to simulate a real report (Goal: Synthesize). All choices prioritize interactivity and clarity for a hands-on educational experience, using only HTML/CSS and JS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .font-mono {
            font-family: 'Inconsolata', monospace;
        }
        .tab-active {
            border-color: #0891b2; /* cyan-600 */
            color: #0891b2; /* cyan-600 */
            background-color: #ecfeff; /* cyan-50 */
        }
        .tab-inactive {
            border-color: transparent;
            color: #475569; /* slate-600 */
        }
        .step-card {
            background-color: white;
            border-left: 4px solid #0891b2; /* cyan-600 */
            transition: transform 0.2s ease-in-out;
        }
        .step-card:hover {
            transform: translateY(-2px);
        }
        .checklist-item.completed label {
            text-decoration: line-through;
            color: #64748b; /* slate-500 */
        }
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: #f1f5f9; /* slate-100 */
            color: #475569; /* slate-600 */
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.75rem;
            cursor: pointer;
            opacity: 0;
            transition: opacity 0.2s ease-in-out;
        }
        pre:hover .copy-btn {
            opacity: 1;
        }
        .process-step {
            flex: 1;
            min-width: 120px;
        }
        .process-arrow {
            color: #cbd5e1; /* slate-300 */
        }
    </style>
</head>
<body class="text-slate-700">

    <div class="container mx-auto p-4 sm:p-6 lg:p-8">
        
        <header class="text-center mb-10">
            <h1 class="text-3xl sm:text-4xl font-bold text-slate-800">Digital Forensics Lab</h1>
            <p class="mt-2 text-lg text-slate-600">Investigating a Compromised System with SANS SIFT</p>
        </header>

        <nav class="flex justify-center border-b border-slate-200 mb-8">
            <button data-tab="overview" class="main-tab py-4 px-6 font-medium text-sm sm:text-base border-b-2 transition-colors duration-200">Overview</button>
            <button data-tab="setup" class="main-tab py-4 px-6 font-medium text-sm sm:text-base border-b-2 transition-colors duration-200">Lab Setup</button>
            <button data-tab="workbench" class="main-tab py-4 px-6 font-medium text-sm sm:text-base border-b-2 transition-colors duration-200">Workbench</button>
            <button data-tab="findings" class="main-tab py-4 px-6 font-medium text-sm sm:text-base border-b-2 transition-colors duration-200">Findings</button>
        </nav>

        <main>
            <!-- Overview Section -->
            <section id="overview" class="main-content space-y-8">
                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">Welcome, Investigator</h2>
                    <p class="text-slate-600 leading-relaxed">
                        Welcome to the Digital Forensics and Incident Response (DFIR) lab. In this exercise, you will take on the role of a forensic investigator. You will use the SANS Investigative Forensic Toolkit (SIFT) Workstation, a powerful suite of open-source tools, to analyze a disk image from a system suspected to be involved in a data breach. This interactive lab is designed to provide you with hands-on experience with industry-standard tools and techniques in a structured environment.
                    </p>
                </div>
                
                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">Lab Objectives</h2>
                    <ul class="space-y-3 text-slate-600">
                        <li class="flex items-start"><span class="mr-3 text-cyan-600">&#10004;</span><span>Set up and use the SANS SIFT Workstation.</span></li>
                        <li class="flex items-start"><span class="mr-3 text-cyan-600">&#10004;</span><span>Perform a forensic analysis of a disk image using Autopsy.</span></li>
                        <li class="flex items-start"><span class="mr-3 text-cyan-600">&#10004;</span><span>Create and analyze a system timeline to understand user activity.</span></li>
                        <li class="flex items-start"><span class="mr-3 text-cyan-600">&#10004;</span><span>Identify and extract key artifacts to support an investigation.</span></li>
                        <li class="flex items-start"><span class="mr-3 text-cyan-600">&#10004;</span><span>Answer critical questions about the incident based on your findings.</span></li>
                    </ul>
                </div>

                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">Investigation Workflow</h2>
                    <p class="text-slate-600 mb-6">This lab follows a standard digital forensic process. The diagram below outlines the major phases you will complete. Use the navigation tabs above to move through each phase.</p>
                    <div class="flex flex-col sm:flex-row items-center justify-between space-y-4 sm:space-y-0 sm:space-x-4 text-center">
                        <div class="process-step p-4 bg-slate-100 rounded-lg">
                            <div class="text-sm font-bold text-cyan-700">PHASE 1</div>
                            <div class="text-slate-800 font-semibold">Setup</div>
                        </div>
                        <div class="process-arrow text-2xl font-light">&#8594;</div>
                        <div class="process-step p-4 bg-slate-100 rounded-lg">
                            <div class="text-sm font-bold text-cyan-700">PHASE 2</div>
                            <div class="text-slate-800 font-semibold">Analysis</div>
                        </div>
                        <div class="process-arrow text-2xl font-light">&#8594;</div>
                        <div class="process-step p-4 bg-slate-100 rounded-lg">
                            <div class="text-sm font-bold text-cyan-700">PHASE 3</div>
                            <div class="text-slate-800 font-semibold">Reporting</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Setup Section -->
            <section id="setup" class="main-content hidden">
                 <div class="bg-white p-6 sm:p-8 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">Lab Setup Checklist</h2>
                    <p class="text-slate-600 mb-6">Before starting the investigation, ensure your environment is set up correctly. Check off each item as you complete it.</p>
                    <div class="space-y-4">
                        <div class="checklist-item p-4 border rounded-lg transition-colors duration-200">
                            <input type="checkbox" id="req1" class="mr-3 h-5 w-5 rounded border-gray-300 text-cyan-600 focus:ring-cyan-500">
                            <label for="req1" class="font-medium text-slate-700">Host Computer: At least 8GB RAM & 50GB free disk space.</label>
                        </div>
                        <div class="checklist-item p-4 border rounded-lg transition-colors duration-200">
                            <input type="checkbox" id="req2" class="mr-3 h-5 w-5 rounded border-gray-300 text-cyan-600 focus:ring-cyan-500">
                            <label for="req2" class="font-medium text-slate-700">Virtualization Software: VirtualBox or VMware installed.</label>
                        </div>
                        <div class="checklist-item p-4 border rounded-lg transition-colors duration-200">
                            <input type="checkbox" id="req3" class="mr-3 h-5 w-5 rounded border-gray-300 text-cyan-600 focus:ring-cyan-500">
                            <label for="req3" class="font-medium text-slate-700">SIFT VM Downloaded: Get it from the <a href="https://www.sans.org/tools/sift-workstation/" target="_blank" class="text-cyan-600 hover:underline">SANS website</a>.</label>
                        </div>
                         <div class="checklist-item p-4 border rounded-lg transition-colors duration-200">
                            <input type="checkbox" id="req4" class="mr-3 h-5 w-5 rounded border-gray-300 text-cyan-600 focus:ring-cyan-500">
                            <label for="req4" class="font-medium text-slate-700">SIFT VM Imported & Started: Login with `sansforensics` / `forensics`.</label>
                        </div>
                        <div class="checklist-item p-4 border rounded-lg transition-colors duration-200">
                            <input type="checkbox" id="req5" class="mr-3 h-5 w-5 rounded border-gray-300 text-cyan-600 focus:ring-cyan-500">
                            <label for="req5" class="font-medium text-slate-700">Evidence File Downloaded: Get `nps-2008-m57-jean.E01` from <a href="https://digitalcorpora.org/corpora/disk-images/nps-2008-m57-jean" target="_blank" class="text-cyan-600 hover:underline">Digital Corpora</a>.</label>
                        </div>
                        <div class="checklist-item p-4 border rounded-lg transition-colors duration-200">
                            <input type="checkbox" id="req6" class="mr-3 h-5 w-5 rounded border-gray-300 text-cyan-600 focus:ring-cyan-500">
                            <label for="req6" class="font-medium text-slate-700">Evidence Accessible in SIFT: Use a shared folder (e.g., mounted at `/media/sf_folder_name`).</label>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Workbench Section -->
            <section id="workbench" class="main-content hidden">
                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-slate-800 mb-2">Case Briefing: M57-Jean</h2>
                    <p class="text-slate-600 leading-relaxed">
                        You are a forensic investigator assigned to a case involving an employee named Jean. It is suspected that Jean may have been involved in leaking sensitive corporate documents. Your task is to analyze a forensic image of a USB drive that belonged to Jean and determine if any suspicious activity took place.
                    </p>
                </div>
                
                <div class="mt-8">
                    <div class="flex border-b border-slate-200">
                        <button data-tab="autopsy" class="workbench-tab py-3 px-5 font-medium text-sm sm:text-base border-b-2 transition-colors duration-200">Phase 1: Filesystem Analysis (Autopsy)</button>
                        <button data-tab="plaso" class="workbench-tab py-3 px-5 font-medium text-sm sm:text-base border-b-2 transition-colors duration-200">Phase 2: Timeline Analysis (plaso)</button>
                    </div>

                    <div class="mt-6 space-y-6">
                        <!-- Autopsy Content -->
                        <div id="autopsy-content" class="workbench-content space-y-6">
                            <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 1: Launch Autopsy</h3>
                                <p class="text-slate-600 mb-4">Open a terminal in your SIFT Workstation and run the following command:</p>
                                <pre class="bg-slate-800 text-white p-4 rounded-md font-mono text-sm relative"><code class="language-bash">autopsy</code><button class="copy-btn" onclick="copyCode(this)">Copy</button></pre>
                            </div>
                            <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 2: Create a New Case</h3>
                                <ul class="list-disc list-inside text-slate-600 space-y-1">
                                    <li>Click "Create New Case".</li>
                                    <li>Enter a case name (e.g., "M57-Jean Investigation") and select a directory.</li>
                                    <li>Enter your name as the examiner.</li>
                                </ul>
                            </div>
                            <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 3: Add Data Source</h3>
                                <ul class="list-disc list-inside text-slate-600 space-y-1">
                                    <li>Select "Disk Image or VM File" as the data source type.</li>
                                    <li>Browse to the location of your evidence file (`nps-2008-m57-jean.E01`).</li>
                                    <li>Leave other settings as default and click "Next".</li>
                                </ul>
                            </div>
                            <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 4: Configure & Run Ingest Modules</h3>
                                <p class="text-slate-600">Keep the default ingest modules selected. These modules will automatically perform various analysis tasks like file type identification, keyword searching, and metadata extraction. Click "Next" to start the analysis. This process will take some time.</p>
                            </div>
                             <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 5: Explore the Evidence</h3>
                                <p class="text-slate-600">Once ingest is complete, explore the filesystem. Use the tree view on the left to navigate different data views, such as "File Views" (by file type, deleted files, etc.) and "Data Artifacts" (web history, registry, etc.).</p>
                            </div>
                        </div>

                        <!-- Plaso Content -->
                        <div id="plaso-content" class="workbench-content hidden space-y-6">
                            <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 1: Run log2timeline</h3>
                                <p class="text-slate-600 mb-4">This command creates a timeline from the disk image, parsing artifacts and storing them in a `.plaso` file. Replace `/path/to/your/` with the actual path to your evidence file.</p>
                                <pre class="bg-slate-800 text-white p-4 rounded-md font-mono text-sm relative"><code class="language-bash">log2timeline.py m57-jean.plaso /path/to/your/nps-2008-m57-jean.E01</code><button class="copy-btn" onclick="copyCode(this)">Copy</button></pre>
                            </div>
                            <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 2: Sort the Timeline</h3>
                                <p class="text-slate-600 mb-4">Use `psort.py` to convert the `.plaso` database into a human-readable CSV file for analysis in a spreadsheet program.</p>
                                <pre class="bg-slate-800 text-white p-4 rounded-md font-mono text-sm relative"><code class="language-bash">psort.py -o l2tcsv -w m57-jean-timeline.csv m57-jean.plaso</code><button class="copy-btn" onclick="copyCode(this)">Copy</button></pre>
                            </div>
                            <div class="step-card p-6 rounded-lg shadow-sm">
                                <h3 class="font-bold text-lg text-slate-800 mb-2">Step 3: Analyze the Timeline</h3>
                                <p class="text-slate-600">Open the generated `m57-jean-timeline.csv` file with LibreOffice Calc or another spreadsheet tool. Filter and sort the data to look for interesting events, such as file creation/modification times, program execution, and other user activities.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Findings Section -->
            <section id="findings" class="main-content hidden">
                <div class="bg-white p-6 sm:p-8 rounded-lg shadow-sm">
                    <h2 class="text-2xl font-bold text-slate-800 mb-4">Investigation Findings Report</h2>
                    <p class="text-slate-600 mb-6">Use your analysis from the Workbench to answer the following questions. Document your findings in the spaces provided.</p>
                    <div class="space-y-8">
                        <div>
                            <label for="q1" class="block font-semibold text-slate-700 mb-2">1. What is the volume name of the USB drive?</label>
                            <textarea id="q1" rows="2" class="w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition"></textarea>
                        </div>
                        <div>
                            <label for="q2" class="block font-semibold text-slate-700 mb-2">2. Are there any deleted files on the USB drive? If so, what are their names?</label>
                            <textarea id="q2" rows="3" class="w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition"></textarea>
                        </div>
                        <div>
                            <label for="q3" class="block font-semibold text-slate-700 mb-2">3. Can you find any documents with the ".doc" or ".pdf" extension? What are their contents?</label>
                            <textarea id="q3" rows="3" class="w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition"></textarea>
                        </div>
                        <div>
                            <label for="q4" class="block font-semibold text-slate-700 mb-2">4. Are there any images on the drive? What do they depict?</label>
                            <textarea id="q4" rows="3" class="w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition"></textarea>
                        </div>
                        <div>
                            <label for="q5" class="block font-semibold text-slate-700 mb-2">5. Based on the timeline, when was the USB drive last accessed?</label>
                            <textarea id="q5" rows="2" class="w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition"></textarea>
                        </div>
                        <div>
                            <label for="q6" class="block font-semibold text-slate-700 mb-2">6. Is there any evidence of web browsing activity? What websites were visited?</label>
                            <textarea id="q6" rows="3" class="w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition"></textarea>
                        </div>
                        <div>
                            <label for="q7" class="block font-semibold text-slate-700 mb-2">7. What is the overall conclusion of your investigation? Did Jean leak sensitive data?</label>
                            <textarea id="q7" rows="4" class="w-full p-2 border border-slate-300 rounded-md focus:ring-2 focus:ring-cyan-500 focus:border-cyan-500 transition"></textarea>
                        </div>
                    </div>
                </div>
            </section>
        </main>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const mainTabs = document.querySelectorAll('.main-tab');
            const mainContents = document.querySelectorAll('.main-content');
            const workbenchTabs = document.querySelectorAll('.workbench-tab');
            const workbenchContents = document.querySelectorAll('.workbench-content');
            const checklistItems = document.querySelectorAll('.checklist-item input[type="checkbox"]');

            function switchTab(tabs, contents, activeTab) {
                tabs.forEach(tab => {
                    const tabName = tab.dataset.tab;
                    if (tabName === activeTab.dataset.tab) {
                        tab.classList.add('tab-active');
                        tab.classList.remove('tab-inactive');
                    } else {
                        tab.classList.remove('tab-active');
                        tab.classList.add('tab-inactive');
                    }
                });

                contents.forEach(content => {
                    if (content.id === activeTab.dataset.tab || content.id === `${activeTab.dataset.tab}-content`) {
                        content.classList.remove('hidden');
                    } else {
                        content.classList.add('hidden');
                    }
                });
            }

            mainTabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(mainTabs, mainContents, tab));
            });

            workbenchTabs.forEach(tab => {
                tab.addEventListener('click', () => switchTab(workbenchTabs, workbenchContents, tab));
            });
            
            checklistItems.forEach(checkbox => {
                checkbox.addEventListener('change', function() {
                    const parent = this.closest('.checklist-item');
                    if (this.checked) {
                        parent.classList.add('completed');
                    } else {
                        parent.classList.remove('completed');
                    }
                });
            });

            // Set initial state
            switchTab(mainTabs, mainContents, mainTabs[0]);
            switchTab(workbenchTabs, workbenchContents, workbenchTabs[0]);
        });
        
        function copyCode(button) {
            const pre = button.parentElement;
            const code = pre.querySelector('code');
            const text = code.innerText;

            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            try {
                document.execCommand('copy');
                button.innerText = 'Copied!';
                setTimeout(() => {
                    button.innerText = 'Copy';
                }, 2000);
            } catch (err) {
                console.error('Failed to copy text: ', err);
            }
            document.body.removeChild(textArea);
        }
    </script>

</body>
</html>
